{"version":3,"file":"bundle.js","sources":["../../src/scripts/index.js","../../src/scripts/sampleBotnet.js","../../src/scripts/ControllerBot.js","../../src/scripts/WorkerBot.js"],"sourcesContent":["import sampleBotnet from \"./sampleBotnet.js\";\r\nlet canvas = document.getElementById(\"grid\");\r\nconst CANVAS_SIZE = canvas.width;\r\nconst SQUARE_SIZE = CANVAS_SIZE / 100;\r\nlet context = canvas.getContext(\"2d\");\r\nlet gridlines = true;\r\nlet botClasses = [sampleBotnet.toString()];\r\nlet rounds = 1000;\r\nlet counter = document.getElementById(\"round-counter\");\r\nlet worker = undefined;\r\nfunction displayGrid(grid) {\r\n\tcontext.clearRect(0, 0, canvas.width, canvas.height);\r\n\tcounter.textContent = parseInt(counter.textContent, 10) + 1;\r\n\tfor (let i = 0; i < 100; i++) {\r\n\t\tfor (let j = 0; j < 100; j++) {\r\n\t\t\tlet square = grid[i][j];\r\n\t\t\tlet dimensions = [\r\n\t\t\t\ti * SQUARE_SIZE,\r\n\t\t\t\tj * SQUARE_SIZE,\r\n\t\t\t\tSQUARE_SIZE,\r\n\t\t\t\tSQUARE_SIZE\r\n\t\t\t];\r\n\t\t\tif (square !== \"\") {\r\n\t\t\t\tif (square === \"C\") {\r\n\t\t\t\t\t//coin\r\n\t\t\t\t\tcontext.fillStyle = \"rgb(255,255,0)\";\r\n\t\t\t\t} else if (square[0] === \"B\") {\r\n\t\t\t\t\tcontext.fillStyle = square[1];\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconsole.error(`Invalid Square:${square}`);\r\n\t\t\t\t}\r\n\t\t\t\tcontext.fillRect(...dimensions);\r\n\t\t\t} else if (gridlines) {\r\n\t\t\t\tcontext.lineWidth = 0.3;\r\n\t\t\t\tcontext.strokeStyle = \"rgb(20,20,20)\";\r\n\t\t\t\tcontext.strokeRect(...dimensions);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\nfunction displayResults(results) {\r\n\tlet rankings = document.getElementById(\"rankings\");\r\n\trankings.innerHTML = \"\";\r\n\tfor (let row of results) {\r\n\t\tlet ranking = document.createElement(\"li\");\r\n\t\tranking.append(`${row[0]}: ${row[1]} Gold`);\r\n\t\trankings.append(ranking);\r\n\t}\r\n\tconsole.log(results);\r\n}\r\nfunction endWorker() {\r\n\tworker.terminate();\r\n\tdelete window.worker;\r\n}\r\nif (window.Worker) {\r\n\tdocument\r\n\t\t.getElementById(\"run-game\")\r\n\t\t.addEventListener(\"click\", function(event) {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tcounter.textContent = \"0\";\r\n\t\t\tlet displayInterval = parseInt(\r\n\t\t\t\tdocument.getElementById(\"display-interval\").value,\r\n\t\t\t\t10\r\n\t\t\t);\r\n\t\t\tlet testBotnet = document.getElementById(\"test-botnet\").value;\r\n\t\t\tlet allBotClasses;\r\n\t\t\tif (testBotnet.length > 0) {\r\n\t\t\t\tallBotClasses = botClasses.concat(testBotnet);\r\n\t\t\t} else {\r\n\t\t\t\tallBotClasses = botClasses;\r\n\t\t\t}\r\n\t\t\tif (worker) {\r\n\t\t\t\tendWorker();\r\n\t\t\t}\r\n\t\t\tworker = new Worker(\"./worker.js\");\r\n\t\t\tworker.postMessage({\r\n\t\t\t\tbotClasses: allBotClasses,\r\n\t\t\t\trounds,\r\n\t\t\t\tdisplayInterval\r\n\t\t\t});\r\n\t\t\tworker.onmessage = function(event) {\r\n\t\t\t\tif (event.data[0] === \"update\") {\r\n\t\t\t\t\tlet grid = event.data[1];\r\n\t\t\t\t\tdisplayGrid(grid);\r\n\t\t\t\t} else if (event.data[0] === \"end\") {\r\n\t\t\t\t\tdisplayResults(event.data[1]);\r\n\t\t\t\t\tendWorker();\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t});\r\n\tdocument.getElementById(\"stop-game\").addEventListener(\"click\", endWorker);\r\n} else {\r\n\tconsole.error(\"Worker API Unsupported. Please use another browser\");\r\n}\r\n","/* eslint constructor-super:0,no-this-before-super:0,no-unused-vars:0*/\r\nimport ControllerBot from \"./ControllerBot.js\";\r\nimport WorkerBot from \"./WorkerBot.js\";\r\n\r\nexport default function sampleBotnet() {\r\n\tclass SampleControllerBot extends ControllerBot {\r\n\t\tconstructor(locations) {\r\n\t\t\tsuper(locations);\r\n\t\t\tthis.storage = \"\";\r\n\t\t}\r\n\t\tsendMessage(messages, index) {\r\n\t\t\tlet surrondings = messages.find(message => message[0] === index)[1];\r\n\t\t\tlet otherBot = surrondings.findIndex(\r\n\t\t\t\t(square, i) =>\r\n\t\t\t\t\tsquare === \"B\" && [6, 7, 8, 11, 13, 16, 17, 18].includes(i)\r\n\t\t\t);\r\n\t\t\tif (otherBot !== -1) {\r\n\t\t\t\treturn [\"kill\", otherBot];\r\n\t\t\t}\r\n\t\t\tlet coin = surrondings.findIndex(\r\n\t\t\t\t(square, i) =>\r\n\t\t\t\t\tsquare === \"C\" && [6, 7, 8, 11, 13, 16, 17, 18].includes(i)\r\n\t\t\t);\r\n\t\t\tif (coin !== -1) {\r\n\t\t\t\treturn [\"move\", coin];\r\n\t\t\t}\r\n\t\t\tlet validMoves = [6, 7, 8, 11, 13, 16, 17, 18].filter(\r\n\t\t\t\tx => surrondings[x] === \"\"\r\n\t\t\t);\r\n\t\t\treturn [\r\n\t\t\t\t\"move\",\r\n\t\t\t\tvalidMoves[Math.floor(Math.random() * validMoves.length)]\r\n\t\t\t];\r\n\t\t}\r\n\t}\r\n\tclass SampleWorkerBot extends WorkerBot {\r\n\t\tperformAction(message) {\r\n\t\t\treturn message;\r\n\t\t}\r\n\t\tsendMessage(x, y, surroundings) {\r\n\t\t\treturn [this.index, surroundings];\r\n\t\t}\r\n\t}\r\n\treturn {\r\n\t\tname: \"SampleBotnet\",\r\n\t\tcolor: \"red\",\r\n\t\tcontrollerBot: SampleControllerBot,\r\n\t\tworkerBot: SampleWorkerBot\r\n\t};\r\n}\r\n","/*eslint no-unused-vars:0*/\r\nexport default class ControllerBot {\r\n\tconstructor(locations) {\r\n\t\tthis.storage = \"\";\r\n\t}\r\n\tsendMessage(messages, index) {\r\n\t\treturn \"\";\r\n\t}\r\n}\r\n","/*eslint no-unused-vars:0*/\r\nclass WorkerBot {\r\n\tconstructor(index) {\r\n\t\tthis.index = index;\r\n\t}\r\n\tperformAction(message) {}\r\n\tsendMessage(x, y, surroundings) {}\r\n}\r\n/*let oldHasInstance = WorkerBot[Symbol.hasInstance].bind({});\r\nObject.defineProperty(WorkerBot, Symbol.hasInstance, {\r\n\tvalue: function(instance) {\r\n\t\treturn instance instanceof WorkerBotWrapper || oldHasInstance;\r\n\t}\r\n});*/\r\nexport default WorkerBot;\r\n"],"names":["canvas","document","getElementById","SQUARE_SIZE","width","context","getContext","botClasses","name","color","controllerBot","constructor","locations","storage","sendMessage","messages","index","surrondings","find","message","otherBot","findIndex","square","i","includes","coin","validMoves","filter","x","Math","floor","random","length","workerBot","performAction","y","surroundings","this","toString","counter","worker","undefined","endWorker","terminate","window","Worker","addEventListener","event","preventDefault","textContent","allBotClasses","displayInterval","parseInt","value","testBotnet","concat","postMessage","rounds","onmessage","data","grid","clearRect","height","j","dimensions","fillStyle","console","error","fillRect","lineWidth","strokeStyle","strokeRect","displayGrid","results","rankings","innerHTML","row","ranking","createElement","append","log","displayResults"],"mappings":"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"}