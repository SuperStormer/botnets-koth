{"version":3,"file":"worker.js","sources":["../../src/scripts/utils.js","../../src/scripts/WorkerBotWrapper.js","../../src/scripts/WorkerBot.js","../../src/scripts/ControllerBot.js","../../src/scripts/Controller.js","../../src/scripts/worker.js"],"sourcesContent":["//from https://stackoverflow.com/a/1527820/\r\nlet randInt = (min, max) => Math.floor(Math.random() * (max - min + 1)) + min;\r\n//from https://stackoverflow.com/a/12646864/7941251\r\nfunction shuffle(array) {\r\n\t//in place\r\n\tarray;\r\n\tfor (var i = array.length - 1; i > 0; i--) {\r\n\t\tvar j = Math.floor(Math.random() * (i + 1));\r\n\t\tvar temp = array[i];\r\n\t\tarray[i] = array[j];\r\n\t\tarray[j] = temp;\r\n\t}\r\n}\r\n//adapted from https://davidwalsh.name/essential-javascript-functions\r\nfunction debounce(func, wait, immediate) {\r\n\tlet timeout;\r\n\treturn function() {\r\n\t\tlet context = this,\r\n\t\t\targs = arguments;\r\n\t\tlet later = function() {\r\n\t\t\ttimeout = null;\r\n\t\t\tif (!immediate) {\r\n\t\t\t\tfunc.apply(context, args);\r\n\t\t\t}\r\n\t\t};\r\n\t\tlet callNow = immediate && !timeout;\r\n\t\tclearTimeout(timeout);\r\n\t\ttimeout = setTimeout(later, wait);\r\n\t\tif (callNow) {\r\n\t\t\tfunc.apply(context, args);\r\n\t\t}\r\n\t};\r\n}\r\nexport { randInt, shuffle, debounce };\r\n","/*eslint no-unused-vars:0*/\r\nexport default class WorkerBotWrapper {\r\n\tconstructor(x, y, index, name, color, botClass) {\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\t\tthis.index = index;\r\n\t\tthis.gold = 0;\r\n\t\tthis.color = color;\r\n\t\tthis.bot = new botClass(index);\r\n\t\tthis.name = `${name}#${index}`;\r\n\t\tthis.stunnedRound = undefined;\r\n\t}\r\n\tperformAction(message) {\r\n\t\treturn this.bot.performAction(message);\r\n\t}\r\n\tsendMessage(x, y, surrondings) {\r\n\t\treturn this.bot.sendMessage(x, y, surrondings);\r\n\t}\r\n}\r\n","import WorkerBotWrapper from \"./WorkerBotWrapper.js\";\r\n\r\n/*eslint no-unused-vars:0*/\r\nclass WorkerBot {\r\n\tconstructor(index) {\r\n\t\tthis.index = index;\r\n\t}\r\n\tperformAction(message) {}\r\n\tsendMessage(x, y, surroundings) {}\r\n}\r\n/*let oldHasInstance = WorkerBot[Symbol.hasInstance].bind({});\r\nObject.defineProperty(WorkerBot, Symbol.hasInstance, {\r\n\tvalue: function(instance) {\r\n\t\treturn instance instanceof WorkerBotWrapper || oldHasInstance;\r\n\t}\r\n});*/\r\nexport default WorkerBot;\r\n","/*eslint no-unused-vars:0*/\r\nexport default class ControllerBot {\r\n\tconstructor(locations) {\r\n\t\tthis.storage = \"\";\r\n\t}\r\n\tsendMessage(messages, index) {\r\n\t\treturn \"\";\r\n\t}\r\n}\r\n","import { randInt, shuffle } from \"./utils.js\";\r\nimport WorkerBot from \"./WorkerBot.js\";\r\nimport ControllerBot from \"./ControllerBot.js\";\r\nimport WorkerBotWrapper from \"./WorkerBotWrapper.js\";\r\nconst STARTING_COINS = 100;\r\nconst COINS_PER_ROUND = 10;\r\nconst NUM_WORKER_BOTS = 20;\r\nexport default class Controller {\r\n\tconstructor(botClasses, displayFunc) {\r\n\t\tthis.displayFunc = displayFunc;\r\n\t\tthis.botClasses = botClasses.filter(\r\n\t\t\tbotClasses2 =>\r\n\t\t\t\tbotClasses2.controllerBot.prototype instanceof ControllerBot &&\r\n\t\t\t\tbotClasses2.workerBot.prototype instanceof WorkerBot\r\n\t\t);\r\n\t}\r\n\trunGame() {\r\n\t\tthis.initGrid();\r\n\t\tshuffle(this.botnets);\r\n\t\tthis.botnets = this.botnets.slice(0, 15);\r\n\t\tfor (let i = 0; i < 1; i++) {\r\n\t\t\tthis.runRound(i);\r\n\t\t}\r\n\t\treturn this.botnets\r\n\t\t\t.sort((a, b) => a.gold - b.gold)\r\n\t\t\t.map(\r\n\t\t\t\t(botnet, i) =>\r\n\t\t\t\t\t`${i + 1}. ${botnet.name}:${botnet.workerBots.reduce(\r\n\t\t\t\t\t\t(a, b) => a.gold + b.gold,\r\n\t\t\t\t\t\t0\r\n\t\t\t\t\t)} Gold`\r\n\t\t\t)\r\n\t\t\t.join(\"\\n\");\r\n\t}\r\n\trunRound(round) {\r\n\t\tconsole.log(round);\r\n\t\tfor (let i = 0; i < COINS_PER_ROUND; i++) {\r\n\t\t\ttry {\r\n\t\t\t\tthis.generateCoin();\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.warn(\"No free space for coins\");\r\n\t\t\t}\r\n\t\t}\r\n\t\tshuffle(this.botnets);\r\n\t\tlet workerBots = this.botnets.flatMap(botnet => botnet.workerBots);\r\n\t\tfor (let botnet of this.botnets) {\r\n\t\t\tfor (let i = 0; i < botnet.workerBots.length; i++) {\r\n\t\t\t\tlet workerBot = botnet.workerBots[i];\r\n\t\t\t\tif (\r\n\t\t\t\t\tworkerBot.stunnedRound === undefined ||\r\n\t\t\t\t\tworkerBot.stunnedRound === round - 1\r\n\t\t\t\t) {\r\n\t\t\t\t\tworkerBot.stunnedRound = undefined;\r\n\t\t\t\t\tlet allMessages = workerBots.map(workerBot2 =>\r\n\t\t\t\t\t\tworkerBot2.sendMessage(\r\n\t\t\t\t\t\t\tworkerBot2.x,\r\n\t\t\t\t\t\t\tworkerBot2.y,\r\n\t\t\t\t\t\t\tthis.getSurroundings(workerBot2.x, workerBot2.y)\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t);\r\n\t\t\t\t\tlet controllerBotMessage = botnet.controllerBot.sendMessage(\r\n\t\t\t\t\t\tallMessages,\r\n\t\t\t\t\t\ti\r\n\t\t\t\t\t);\r\n\t\t\t\t\tlet action = workerBot.performAction(controllerBotMessage);\r\n\t\t\t\t\tif (!this.handleAction(action, workerBot)) {\r\n\t\t\t\t\t\tconsole.log(\r\n\t\t\t\t\t\t\t`${workerBot.name} made an invalid action(${action})`\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\t//emp'd\r\n\t\t\t\t\tconsole.log(`${workerBot.name} was EMP'd`);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.display();\r\n\t}\r\n\tinitGrid() {\r\n\t\tthis.grid = new Array(100); //indexed [y,x]\r\n\t\tfor (let i = 0; i < 100; i++) {\r\n\t\t\tthis.grid[i] = new Array(100).fill(\"\");\r\n\t\t}\r\n\t\tthis.botnets = this.botClasses.map(botClasses2 => {\r\n\t\t\tlet workerBots = [];\r\n\t\t\tfor (let i = 0; i < NUM_WORKER_BOTS; i++) {\r\n\t\t\t\tworkerBots.push(\r\n\t\t\t\t\tthis.generateWorkerBot(\r\n\t\t\t\t\t\ti,\r\n\t\t\t\t\t\tbotClasses2.name,\r\n\t\t\t\t\t\tbotClasses2.color,\r\n\t\t\t\t\t\tbotClasses2.workerBot\r\n\t\t\t\t\t)\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\tlet controllerBot = new botClasses2.controllerBot(\r\n\t\t\t\tworkerBots.map(bot => [bot.x, bot.y])\r\n\t\t\t);\r\n\t\t\treturn {\r\n\t\t\t\tname: botClasses2.name,\r\n\t\t\t\tcontrollerBot,\r\n\t\t\t\tworkerBots\r\n\t\t\t};\r\n\t\t});\r\n\t\tfor (let i = 0; i < STARTING_COINS; i++) {\r\n\t\t\tthis.generateCoin();\r\n\t\t}\r\n\t}\r\n\thandleAction(action, bot) {\r\n\t\t//returns true if action was valid\r\n\t\tswitch (action[0]) {\r\n\t\t\tcase \"kill\":\r\n\t\t\t\tif ([6, 7, 8, 11, 12, 13, 16, 17, 18].includes(action[1])) {\r\n\t\t\t\t\tlet coords = this.surroundingsIndexToCoords(\r\n\t\t\t\t\t\taction[1],\r\n\t\t\t\t\t\tbot.x,\r\n\t\t\t\t\t\tbot.y\r\n\t\t\t\t\t);\r\n\t\t\t\t\tlet square = this.grid[coords[1]][coords[0]];\r\n\t\t\t\t\tif (square instanceof WorkerBotWrapper) {\r\n\t\t\t\t\t\tlet gold = Math.floor(square.gold);\r\n\t\t\t\t\t\tconsole.log(\r\n\t\t\t\t\t\t\t`${bot.name} killed ${square.name} for ${gold} gold`\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tbot.gold += gold;\r\n\t\t\t\t\t\tsquare = \"\";\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\tcase \"move\":\r\n\t\t\t\tif ([6, 7, 8, 11, 13, 16, 17, 18].includes(action[1])) {\r\n\t\t\t\t\tlet coords = this.surroundingsIndexToCoords(\r\n\t\t\t\t\t\taction[1],\r\n\t\t\t\t\t\tbot.x,\r\n\t\t\t\t\t\tbot.y\r\n\t\t\t\t\t);\r\n\t\t\t\t\tlet square = this.grid[coords[1]][coords[0]];\r\n\t\t\t\t\tif (square === \"\" || square === \"C\") {\r\n\t\t\t\t\t\tthis.grid[bot.y][bot.x] = \"\";\r\n\t\t\t\t\t\tsquare = bot;\r\n\t\t\t\t\t\t[bot.x, bot.y] = coords;\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (action[1] === 12) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\tcase \"emp\":\r\n\t\t\t\tthrow new TypeError(\"emp not implemented\");\r\n\t\t\tdefault:\r\n\t\t\t\tconsole.log(`${bot.name} skipped its turn`);\r\n\t\t}\r\n\t}\r\n\tgenerateCoin() {\r\n\t\tlet x = randInt(0, 99);\r\n\t\tlet y = randInt(0, 99);\r\n\t\tif (this.grid[y][x] === \"\") {\r\n\t\t\tthis.grid[y][x] = \"C\";\r\n\t\t} else {\r\n\t\t\tthis.generateCoin();\r\n\t\t}\r\n\t}\r\n\tgenerateWorkerBot(index, name, color, workerBotClass) {\r\n\t\tlet x = randInt(0, 99);\r\n\t\tlet y = randInt(0, 99);\r\n\t\tif (this.grid[y][x] === \"\") {\r\n\t\t\tlet bot = new WorkerBotWrapper(\r\n\t\t\t\tx,\r\n\t\t\t\ty,\r\n\t\t\t\tindex,\r\n\t\t\t\tname,\r\n\t\t\t\tcolor,\r\n\t\t\t\tworkerBotClass\r\n\t\t\t);\r\n\t\t\tthis.grid[y][x] = bot;\r\n\t\t\treturn bot;\r\n\t\t} else {\r\n\t\t\treturn this.generateWorkerBot(index, name, color, workerBotClass);\r\n\t\t}\r\n\t}\r\n\tgetSurroundings(x, y) {\r\n\t\tlet surroundings = [];\r\n\t\tfor (let i = -2; i <= 2; i++) {\r\n\t\t\tfor (let j = -2; j <= 2; j++) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tsurroundings.push(this.grid[y + i][x + j]);\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tsurroundings.push(\"E\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn surroundings.map(square =>\r\n\t\t\tsquare instanceof WorkerBotWrapper ? \"B\" : square\r\n\t\t);\r\n\t}\r\n\tsurroundingsIndexToCoords(index, x, y) {\r\n\t\t//returns as x,y\r\n\t\treturn [(index % 5) - 2 + x, Math.floor(index / 5) - 2 + y];\r\n\t}\r\n\tdisplay() {\r\n\t\tthis.displayFunc(\r\n\t\t\tthis.grid.map(row =>\r\n\t\t\t\trow.map(square =>\r\n\t\t\t\t\tsquare instanceof WorkerBotWrapper\r\n\t\t\t\t\t\t? [\"B\", square.color]\r\n\t\t\t\t\t\t: square\r\n\t\t\t\t)\r\n\t\t\t)\r\n\t\t);\r\n\t}\r\n}\r\n","import Controller from \"./Controller.js\";\r\nlet eval2 = eval;\r\nonmessage = function(event) {\r\n\tlet botClasses = event.data.map(func => eval2(`(${func})()`));\r\n\tlet controller = new Controller(botClasses, postMessage.bind(this));\r\n\tcontroller.runGame();\r\n};\r\n"],"names":["randInt","min","max","Math","floor","random","shuffle","array","i","length","j","temp","WorkerBotWrapper","constructor","x","y","index","name","color","botClass","gold","bot","stunnedRound","undefined","performAction","message","sendMessage","surrondings","WorkerBot","surroundings","ControllerBot","locations","storage","messages","STARTING_COINS","COINS_PER_ROUND","NUM_WORKER_BOTS","Controller","botClasses","displayFunc","filter","botClasses2","controllerBot","prototype","workerBot","runGame","initGrid","botnets","slice","runRound","sort","a","b","map","botnet","workerBots","reduce","join","round","console","log","generateCoin","error","warn","flatMap","allMessages","workerBot2","getSurroundings","controllerBotMessage","action","handleAction","display","grid","Array","fill","push","generateWorkerBot","includes","coords","surroundingsIndexToCoords","square","TypeError","workerBotClass","row","eval2","eval","onmessage","event","data","func","controller","postMessage","bind"],"mappings":"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"}